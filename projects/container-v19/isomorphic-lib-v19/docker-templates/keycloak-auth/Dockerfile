FROM quay.io/keycloak/keycloak:latest

COPY .env /opt/keycloak/.env

ENV KC_DB=${KC_DB} \
    KC_DB_URL=${KC_DB_URL} \
    KC_DB_USERNAME=${KC_DB_USERNAME} \
    KC_DB_PASSWORD=${KC_DB_PASSWORD} \
    KC_BOOTSTRAP_ADMIN_USERNAME=${KEYCLOAK_ADMIN} \
    KC_BOOTSTRAP_ADMIN_PASSWORD=${KEYCLOAK_ADMIN_PASSWORD} \
    KC_HTTP_ENABLED=${KC_HTTP_ENABLED} \
    KC_HOSTNAME=${KC_HOSTNAME} \
    KC_HEALTH_ENABLED=${KC_HEALTH_ENABLED} \
    KC_METRICS_ENABLED=${KC_METRICS_ENABLED}

EXPOSE 8080 8443

ENTRYPOINT ["./bin/kc.sh"]
CMD ["start-dev"]
